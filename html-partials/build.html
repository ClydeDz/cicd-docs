<script id="buildPartial" type="text/x-mustache">
    <div class="container container-fluid">
        <div class="row">
            <div class="col-xs-12 col-md-8">
                <div class="card">
                    <h2>{{ name }}</h2>
                    <p>
                        <img src="{{ repository.icon }}" id="repositoryIcon" alt="{{ repository.name }}" onerror="errorLoadingRepositoryIcon(this);" width="24" />
                        <a href="{{ repository.url }}">{{ repository.name }}</a>
                        &nbsp;
                        <img src="/images/extend/platforms/vsts/icon.png" id="platformVstsIcon" alt="{{ project.name }}" width="24" />
                        <a href="{{ project.url }}">{{ project.name }}</a>
                    </p>
                    <p>Project description: {{ project.description }}</p>
                    <div>
                        {{#process}}
                        <div class="phase">
                            <h3>Phase: {{ name }}</h3>
                            <div class="row phase-meta">
                                <div class="col-xs-12">
                                    {{#isExecutionTypeParallelismNone}}
                                    <small>
                                        <img src="../images/icons/parallelism.png" width="26" class="page-icon"/>  Parallelism: None
                                    </small>
                                    {{/isExecutionTypeParallelismNone}}

                                    {{#isExecutionTypeParallelismMultiConfig}}
                                    <small>  <img src="../images/icons/parallelism.png" width="26" class="page-icon" />  Parallelism: Multi-config</small>
                                    {{/isExecutionTypeParallelismMultiConfig}}

                                    {{#isExecutionTypeParallelismMultiAgent}}
                                    <small> <img src="../images/icons/parallelism.png" width="26" class="page-icon"/>  Parallelism: Multi-agent</small>
                                    {{/isExecutionTypeParallelismMultiAgent}}
                                    <div class="buffer">&nbsp;</div>
                                    {{#isPhaseAgentful}}
                                    <small>  <img src="../images/icons/agent.png" width="26" class="page-icon" />  Runs on agent</small>
                                    {{/isPhaseAgentful}}

                                    {{#isPhaseAgentless}}
                                    <small>  <img src="../images/icons/server.png" width="26" class="page-icon" />  Runs on server</small>
                                    {{/isPhaseAgentless}}
                                </div>
                            </div>
                            <div class="steps">
                                {{#steps}}
                                <div id="step-{{id}}" class="row">
                                    <div class="col-xs-1">
                                        <img alt="{{ name }}" src="{{icon}}" id="stepIcon-{{id}}" width="32" onerror="errorLoadingImage(this);" />
                                    </div>
                                    <div class="col-xs-9">
                                        {{ name }}<br />
                                        <small class="text-muted">Version: {{ version }}</small>
                                    </div>
                                    <div class="col-xs-1">
                                        {{#enabled}}
                                        <img src="../images/icons/checkmark.png" width="32" />
                                        <!--<i class="mdi mdi-checkbox-marked-circle mdi-24px text-success"></i>-->
                                        {{/enabled}}
                                        {{^enabled}}
                                        <img src="../images/icons/disabled.png" width="30" />
                                        <!--<i class="mdi mdi-checkbox-marked-circle mdi-24px text-muted"></i>-->
                                        {{/enabled}}
                                    </div>
                                    <div class="col-xs-1">
                                        {{#continueOnError}}
                                        <img src="../images/icons/error.png" width="32" />
                                        <!--<i class="mdi mdi-alert-circle mdi-24px text-danger"></i>-->
                                        {{/continueOnError}}
                                        {{^continueOnError}}
                                        <img src="../images/icons/error-disabled.png" width="32" />
                                        <!--<i class="mdi mdi-alert-circle mdi-24px text-muted"></i>-->
                                        {{/continueOnError}}
                                    </div>
                                </div>
                                {{/steps}}
                            </div>
                        </div>
                        {{/process}}
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-md-4">
                <!-- At a glance -->
                <div class="card">
                    <h2>At a glance</h2>
                    <div class="row text-center">
                        <div class="col-xs-4">
                            <div class="text-center">
                                <img src="../images/icons/tasks.png"  width="32"/> 2
                            </div>
                            <div class="text-center">Tasks</div>
                        </div>
                        <div class="col-xs-4">
                            <div class="text-center">
                                <img src="../images/icons/variables.png"  width="32"/>  2
                            </div>
                            <div class="text-center">Variables</div>
                        </div>
                        <div class="col-xs-4">
                            <div class="text-center">
                                <img src="../images/icons/phases.png"  width="32"/>  2
                            </div>
                            <div class="text-center">Phases</div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <p><h3>Author</h3></p>
                    <p>

                        <img src="../images/icons/user.png" width="32" />    {{ author.displayName }}
                    </p>
                    <p>

                        <img src="../images/icons/email.png" width="32"/>   <a href="mailto:{{ author.email }}">{{ author.email }}</a>
                    </p>
                    <p>

                        <img src="../images/icons/time.png" width="32"/>  {{ creationDate }}
                    </p>
                </div>
                <div class="card">
                    <h3>Queue &amp; triggers</h3>
                    <p>
                        <img src="{{ queue.icon }}" alt="{{ queue.name }}" id="queueAgentIcon" onerror="errorLoadingQueueIcon(this);" width="24" /> {{ queue.displayName }}
                    </p>
                    <p>
                        <img src="../images/icons/hosted.png" width="32" />  Is hosted: {{ queue.isHosted }}
                    </p><br />
                    <p>
                        {{#triggers.continousIntegration}}
                        <img src="../images/icons/ci.png" width="32"/> Continous integration enabled
                        {{/triggers.continousIntegration}}
                        {{^triggers.continousIntegration}}
                        <img src="../images/icons/ci-disabled.png" width="32"/> Continous integration disabled
                        {{/triggers.continousIntegration}}
                    </p>
                    <p>
                        {{#triggers.batchChanges}}
                        <img src="../images/icons/batch-changes.png" width="32"/>  Batch changes enabled while a build is in progress
                        {{/triggers.batchChanges}}
                        {{^triggers.batchChanges}}
                        <img src="../images/icons/batch-changes-disabled.png" width="32"/>  Batch changes disabled
                        {{/triggers.batchChanges}}
                    </p>

                </div>
                <div>
                    <!-- Variables and retention rule button -->
                    <button type="button" class="btn button-inverse" data-toggle="modal" data-target="#myModal">Variables</button>
                    <button type="button" class="btn button-inverse" data-toggle="modal" data-target="#buildRetentionRules">Retention rules</button>
                    <!-- Variables modal -->
                    <div id="myModal" class="modal fade" role="dialog">
                        <div class="modal-dialog">
                            <!-- Modal content-->
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h3 class="modal-title">Variables</h3>
                                </div>
                                <div class="modal-body">
                                    <div class="row modal-table-header bg-gradient">
                                        <div class="col-xs-6">
                                            Variable name
                                        </div>
                                        <div class="col-xs-6">
                                            Variable value
                                        </div>
                                    </div>
                                    {{#variables}}
                                    <div class="row modal-table-row">
                                        <div class="col-xs-6">
                                            {{ key }}
                                        </div>
                                        <div class="col-xs-6">
                                            {{ value }}
                                        </div>
                                    </div>
                                    {{/variables}}
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn button-dark" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Retention modal -->
                    <div id="buildRetentionRules" class="modal fade" role="dialog">
                        <div class="modal-dialog">
                            <!-- Modal content-->
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h3 class="modal-title">Retention rules</h3>
                                </div>
                                <div class="modal-body">
                                    <div class="row modal-table-header bg-gradient">
                                        <div class="col-xs-6">
                                            Days to keep
                                        </div>
                                        <div class="col-xs-6">
                                            Minimum good builds to keep
                                        </div>
                                    </div>
                                    {{#retention}}
                                    <div class="row modal-table-row">
                                        <div class="col-xs-6">
                                            {{ daysToKeep }} day(s)
                                        </div>
                                        <div class="col-xs-6">
                                            {{ minimumToKeep }} good build
                                        </div>
                                    </div>
                                    {{/retention}}
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn button-dark" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>